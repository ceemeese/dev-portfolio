---
import ThemeIcon from './ThemeIcon.astro';

interface NavItem {
    title: string;
    label: string;
    href: string;
}

interface Title {
    title: string;
}

const navItems: NavItem[] = [
    { title: 'Sobre mí', label: 'sobre-mi', href: '#sobremi' },
    { title: 'Proyectos', label: 'proyectos', href: '#proyectos' },
    { title: 'Contacto', label: 'contacto', href: 'mailto:cmsalvador92@gmail.com' }
];

const title: Title = {
    title: 'cmalmierca.dev'
};

---
<header id="header" class="fixed top-0 z-30 w-full px-5 py-6 duration-500 md:px-10 md:py-0 xl:px-20 2xl:px-28">

    <!-- Mobile First -->
     <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16 lg:h-18">
            <a href="/" class="text-xl text-secondary font-semibold">{title.title}</a>

            <!-- Botón hamburguesa -->
            <button id="nav__button" class="flex flex-col items-center justify-center w-8 h-8 space-y-1.5 transition-custom md:hidden" >
                <span id="line1" class="w-8 h-0.75 bg-primary transition-transform duration-300 ease-in-out"></span>
                <span id="line2" class="w-8 h-0.75 bg-primary transition-opacity"></span>
                <span id="line3" class="w-8 h-0.75 bg-primary transition-transform duration-300 ease-in-out"></span>
             </button>

            <!-- Menú desktop -->
            <nav id="nav__desktop" class="hidden md:flex items-center space-x-2 lg:space-x-4 lg:absolute lg:left-1/2 transform lg:-translate-x-1/2 rounded-full transition-custom">
                {
                    navItems.map((item) => (
                        <a class="px-1 text-primary text-base hover:text-secondary relative group transition-custom" href={item.href} aria-label={item.label}>{item.title}
                        <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-secondary group-hover:w-full transition-all duration-300"></span>
                        </a>
                        
                    ))

                }
                <ThemeIcon class="px-1 bg-secondary rounded-lg flex items-center lg:w-12 lg:h-12" />
            </nav>

            <!-- Menú mobile -->
            <div id="nav__mobile" class="absolute top-0 left-0 right-0 bg-black shadow-xl transform -translate-y-full opacity-0 invisible transition-all duration-300 md:hidden min-h-screen flex items-center justify-center">
                <nav class="px-4 py-6 space-y-3">
                    {
                        navItems.map((item) => (
                            <a class="block py-2 text-primary hover:text-secondary text-2xl" href={item.href} aria-label={item.label}>{item.title}</a>
                        ))
                    }
                </nav>
            </div>

        </div>
     </div>


</header>



<script>

    //Apertura de menú mobile
    const navButton = document.getElementById('nav__button');
    const navMobile = document.getElementById('nav__mobile');
    var isMenuOpen = false;

    const line1 = document.getElementById('line1');
    const line2 = document.getElementById('line2');
    const line3 = document.getElementById('line3');

    navButton?.addEventListener('click' , () => {

        isMenuOpen = !isMenuOpen;
        
        if (isMenuOpen) {
            line1 && line1.classList.add('rotate-45', 'translate-y-2.25', 'z-100');
            line2 && line2.classList.add('opacity-0');
            line3 && line3.classList.add('-rotate-45', '-translate-y-2.25', 'z-100');

            navMobile?.classList.remove('opacity-0', 'invisible', '-translate-y-full');
            navMobile?.classList.add('opacity-100', 'visible', 'translate-y-0');
        } else {
            line1 && line1.classList.remove('rotate-45', 'translate-y-2.25', 'z-100');
            line2 && line2.classList.remove('opacity-0');
            line3 && line3.classList.remove('-rotate-45', '-translate-y-2.25', 'z-100');

            navMobile?.classList.remove('opacity-100', 'visible', 'translate-y-0');
            navMobile?.classList.add('opacity-0', 'invisible', '-translate-y-full');
        }
    })


    //Cierre de menú mobile al seleccionar enlace
    document.querySelectorAll('#nav__mobile a').forEach(link => {
        link.addEventListener('click', () => {
            if (isMenuOpen) {
                    navButton?.click();
                }
        });
    });



</script>